name: Generate RSS Feed

on:
  schedule:
    - cron: "0 * * * *" # ë§¤ ì •ì‹œë§ˆë‹¤ ì‹¤í–‰ (UTC ê¸°ì¤€)
  workflow_dispatch: # ìˆ˜ë™ ì‹¤í–‰ë„ ê°€ëŠ¥í•˜ê²Œ
jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout Repository
        uses: actions/checkout@v3

      - name: Set up Go
        uses: actions/setup-go@v5
        with:
          go-version: "1.21"

      - name: Load .env
        run: |
          echo "REDDIT_CLIENT_ID=${{ secrets.REDDIT_CLIENT_ID }}" >> .env
          echo "REDDIT_CLIENT_SECRET=${{ secrets.REDDIT_CLIENT_SECRET }}" >> .env
          echo "REDDIT_USERNAME=${{ secrets.REDDIT_USERNAME }}" >> .env
          echo "REDDIT_PASSWORD=${{ secrets.REDDIT_PASSWORD }}" >> .env
          echo "REDDIT_USER_AGENT=${{ secrets.REDDIT_USER_AGENT }}" >> .env

      - name: Install dependencies
        run: go mod tidy

      - name: Run RSS Generator
        run: go run main.go

      - name: Commit and Push rss.xml
        run: |
          git config user.name github-actions
          git config user.email github-actions@github.com
          git add rss.xml
          git commit -m "ğŸ”„ ìë™ ìƒì„±ëœ RSS ì—…ë°ì´íŠ¸"
          git push
